module.exports=[68840,e=>{"use strict";e.i(96017),e.i(26863),e.i(59872),e.i(73625),e.i(18994);var t=e.i(48411);e.i(89139);var r=e.i(45300);let n=(e,n)=>{let l=null,a=(0,t.t)({config:{adapterId:"memory",adapterName:"Memory Adapter",usePlural:!1,debugLogs:n?.debugLogs||!1,customTransformInput:t=>(t.options.advanced?.database?.useNumberId||t.options.advanced?.database?.generateId==="serial")&&"id"===t.field&&"create"===t.action?e[t.model].length+1:t.data,transaction:async t=>{let r=structuredClone(e);try{return await t(a(l))}catch(t){throw Object.keys(e).forEach(t=>{e[t]=r[t]}),t}}},adapter:({getFieldName:t,options:n,getModelName:l})=>{let a=(e,r,n)=>r?e.sort((e,l)=>{let a=t({model:n,field:r.field}),o=e[a],i=l[a],s=0;return s=null==o&&null==i?0:null==o?-1:null==i?1:"string"==typeof o&&"string"==typeof i?o.localeCompare(i):o instanceof Date&&i instanceof Date?o.getTime()-i.getTime():"number"==typeof o&&"number"==typeof i?o-i:"boolean"==typeof o&&"boolean"==typeof i?o===i?0:o?1:-1:String(o).localeCompare(String(i)),"asc"===r.direction?s:-s}):e;function o(t,n,a){let o=(t,n)=>{let l=e[n];if(!l)throw r.logger.error(`[MemoryAdapter] Model ${n} not found in the DB`,Object.keys(e)),Error(`Model ${n} not found`);let a=(e,t)=>{let{field:r,value:n,operator:l}=t;switch(l){case"in":if(!Array.isArray(n))throw Error("Value must be an array");return n.includes(e[r]);case"not_in":if(!Array.isArray(n))throw Error("Value must be an array");return!n.includes(e[r]);case"contains":return e[r].includes(n);case"starts_with":return e[r].startsWith(n);case"ends_with":return e[r].endsWith(n);case"ne":return e[r]!==n;case"gt":return null!=n&&e[r]>n;case"gte":return null!=n&&e[r]>=n;case"lt":return null!=n&&e[r]<n;case"lte":return null!=n&&e[r]<=n;default:return e[r]===n}};return l.filter(e=>{if(!t.length||0===t.length)return!0;let r=a(e,t[0]);for(let n of t){let t=a(e,n);r="OR"===n.connector?r||t:r&&t}return r})};if(!a)return o(t,n);let i=o(t,n),s=new Map,u=new Map;for(let t of i){let n=String(t.id);if(!s.has(n)){let e={...t};for(let[t,r]of Object.entries(a)){let a=l(t);"one-to-one"===r.relation?e[a]=null:(e[a]=[],u.set(`${n}-${t}`,new Set))}s.set(n,e)}let o=s.get(n);for(let[i,s]of Object.entries(a)){let a=l(i),d=e[a];if(!d)throw r.logger.error(`[MemoryAdapter] JoinOption model ${a} not found in the DB`,Object.keys(e)),Error(`JoinOption model ${a} not found`);let c=d.filter(e=>e[s.on.to]===t[s.on.from]);if("one-to-one"===s.relation)o[a]=c[0]||null;else{let e=u.get(`${n}-${i}`),t=s.limit??100,r=0;for(let n of c){if(r>=t)break;!e.has(n.id)&&(o[a].push(n),e.add(n.id),r++)}}}}return Array.from(s.values())}return{create:async({model:t,data:r})=>((n.advanced?.database?.useNumberId||n.advanced?.database?.generateId==="serial")&&(r.id=e[l(t)].length+1),e[t]||(e[t]=[]),e[t].push(r),r),findOne:async({model:e,where:t,join:r})=>{let n=o(t,e,r);return r?n.length?n[0]:null:n[0]||null},findMany:async({model:e,where:t,sortBy:r,limit:n,offset:l,join:i})=>{let s=o(t||[],e,i);if(i){if(!s.length)return[];a(s,r,e);let t=s;return void 0!==l&&(t=t.slice(l)),void 0!==n&&(t=t.slice(0,n)),t}let u=a(s,r,e);return void 0!==l&&(u=u.slice(l)),void 0!==n&&(u=u.slice(0,n)),u||[]},count:async({model:t,where:r})=>r?o(r,t).length:e[t].length,update:async({model:e,where:t,update:r})=>{let n=o(t,e);return n.forEach(e=>{Object.assign(e,r)}),n[0]||null},delete:async({model:t,where:r})=>{let n=e[t],l=o(r,t);e[t]=n.filter(e=>!l.includes(e))},deleteMany:async({model:t,where:r})=>{let n=e[t],l=o(r,t),a=0;return e[t]=n.filter(e=>l.includes(e)?(a++,!1):!l.includes(e)),a},updateMany({model:e,where:t,update:r}){let n=o(t,e);return n.forEach(e=>{Object.assign(e,r)}),n[0]||null}}}});return e=>(l=e,a(e))};e.s(["memoryAdapter",()=>n])}];

//# sourceMappingURL=node_modules_better-auth_dist_adapters_memory-adapter_index_mjs_61d56fbe._.js.map